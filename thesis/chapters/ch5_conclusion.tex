\chapter{Chapter 5. Conclusion and Future Work}

\section{Conclusion}

In this work, we have advanced the science of data-driven modeling of Earth system processes by showing that relatively small ANNs are capable of reasonably emulating the 1-dimensional dynamics of the Noah land surface model at a high temporal resolution out to a two week forecast. In doing so, we demonstrated a variety of techniques for interpreting the ANN results in terms of the properties of Noah-LSM and using physical reasoning on multiple scales, using observations from the full spatiotemporal domain to motivate further investigation of particular regions and individual pixel time series. We also introduced several modifications to the neural network training process that had notable effects on the subsequent model characteristics. Ultimately, we developed an open source software framework that is general enough for similar ANN development and evaluation techniques to be applied to other similar problems. Below we have listed a few of the specific determinations we made about the ANNs' performance with respect to the model architecture and training strategy.

\begin{itemize}
    \item{ANNs that predict the increment change in soil moisture content between time steps are more skillful than those which target the magnitude of the soil moisture state.}
    \item{The inclusion of a structured hidden state which is passed between prediction time steps in the LSTM ANN architecture makes them more effective at capturing temporal dynamics than FNN-style models that only propagate their previous output state.}
    \item{Normalizing soil moisture target values between individual soil textures' wilting and saturation point aligns the dynamic range of different textures, which led to more performant models.}
    %\item{}
    %\item{}
    \item{Loss function manipulations like biasing loss amounts by the magnitude of target changes in moisture content can improve model performance in extreme cases, but introduce a trade-off with performance under normal conditions.}
    \item{Other loss function manipulations like feature-wise normalization coefficients can emphasize or de-emphasize certain outputs.}
\end{itemize}

Furthermore, we were able to develop methods of applying physics-based reasoning to the evaluation results in order to provide insight on directions of improvement for future models. For example, we determined that ANN emulators struggled to capture frozen soil dynamics, especially for sandy soil textures in the surface layer. This behavior is likely related to the exclusion of soil temperature information from model inputs, which are critically important within Noah-LSM for governing soil hydrology in such scenarios; sand error is emphasized mainly because it still demonstrates significant dynamic fluctuations under frozen soil conditions. Nonetheless, sandy regions under cold conditions still maintained mean absolute error rates that were generally less than .1 RSM.

We also discovered that the ANN emulators also had difficulty capturing the strong seasonal variation in transpiration rate in the 10-40cm and 40-100cm layers associated with the cropland vegetation type; although GVF was demonstrated to be an important predictor in the feature importance results, the under-performance is an indication that the ANNs struggled to accommodate the relationship between root uptake and the combination of unique vegetation types with their characteristic GVF seasonality. These instances were shown to result in a wet bias from under-estimation of the amount of water removed from the soil column by plants, which was exacerbated by fine-textured soils like clay that typically have higher water content (which enhances transpiration) and slower hydraulic conductance by default (exaggerating the difference between high and low transpiration amounts). In these cases, we found that the diurnal cycle of transpiration was maintained -- just under-estimated -- and mean absolute error rates for affected typically remained under .8 RSM.

Overall, the models we presented exhibited a widespread slight dry bias around .02 RSM in the 0-10cm layer and wet bias of about .01 RSM in the 40-100cm layer. Overall mean absolute error rates for the best model in our initial search were about .015 RSM in the surface layer, .008 RSM in the 10-40cm layer and .007 in the 40-100cm layers, however later analysis showed that we could improve that performance to some extent be neglecting unneeded inputs and modifying the loss function parameters. The highest error rates were generally at the beginning of the prediction sequence, with average error per hourly time step leveling out below $4\times 10^{-4}$ RSM for the remainder of the sequence, which suggests that the prediction length can be extended further without substantial degradation of forecast skill. These are encouraging initial results for data-driven emulation of 1d hydrologic dynamical models, which likely still leave room for improvement with additional input data sources, further insight into the processes affecting the results, and continued improvements to the data curation, model training, and loss function manipulation strategy.

\section{Future Work}

We are interested in adapting this technique to the NLDAS-3 dataset, which is currently under development using the next-generation Noah-MP as a land surface model. ANN emulation may be able to lower the computational cost and simplify the software environment associated with executing the land surface model in a forecasting capacity, which opens the opportunity for executing large ensembles, and for users to easily manipulate the inputs to evaluate hypothetical scenarios on custom domains without the difficulty of running the full numerical model. Additionally, due to data storage constraints, the NLDAS-3 land model data will only be publicly available at a daily resolution; similar strategies to the ones here may be employed to develop an ANN that interpolates the hourly land surface data from the forcings, which may be provided to users so that they can retrieve hourly land surface states without the need to store 24 times the amount of model data on-disc.

In terms of the continued improvement of the ANNs' capabilities as emulators, the performance of data-driven models is closely related to the statistical properties of the training set, and is limited by the extent to which the predictors can explain the variance of the target variables. As such, further advancement of ANN modeling techniques in this domain are likely to involve adjusting the training data to supplement deficiencies in certain important but under-represented phenomena, and by providing additional information that can mitigate uncertainty. For example, in order to encourage the ANNs to realize the seasonality of cropland vegetation, or to better capture the runoff characteristics of the sparse urban surface type, the training pipeline can be modified to select those sequences more often, or to weight their results more heavily within the loss function. Furthermore, since we are aware that necessary information related to soil temperature is missing from the frozen hydrology estimates, additional ANNs can be developed that emulate thermodynamic processes, and which can be coupled and used to constrain the hydrology emulator. In this manner, a suite of ANN emulators targeting specific physical variables (for example, also including heat fluxes and snow water equivalent) could mutually constitute a uniquely explainable framework for data-driven land surface modeling. In the future, such a system could assimilate physical observations, and may even be able to bootstrap emulation of actual in-situ data rather than just numerical model outputs.

Finally, there are a variety of improvements to the evaluation strategies used here that we would like to implement in the future. For example, the physicality of ANN performance could be characterized with respect to the magnitude of vegetation stress, the infiltration rate of particular soil textures, the actual fraction of frozen soil, etc. We would also like to add a evaluation method that builds a spatiotemporal map of occurrences of ANN behaviors, for example `absolute error over .2 RSM associated with precipitation events greater than 15 $kg\,m^{-2}\,h^{-1}$' or `dry bias with dewpoint depression less than 2 $K$'. Such a system would be incredibly useful for interpreting the circumstances contributing bulk results like those in the histograms presented here, and for identifying special cases of model behavior that can be used for over-sampling training data or identifying case studies. The flexibility of data-driven modeling makes it a promising and valuable technology for supplementing process-based knowledge and modeling approaches, but it is critical to recognize that the subtleties and vicissitudes of the Earth system cannot be sufficiently summarized by optimizing and analyzing the overall mean absolute error. As ANNs continue to evolve and the process of developing them becomes increasingly abstract, it will be critical for practitioners to maintain a physical understanding of the system they are emulating, and to evaluate their results accordingly.
